

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>1.2. Teoría potencial linealizada 2D &#8212; pyAeroBook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/01-rankine/1b.Notebook_RANKINE - SOL';</script>
    <link rel="shortcut icon" href="../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="2. Campo fluido generado por un torbellino individual en presencia de una pared" href="../02-torbellino-pared/2.Notebook_Torbellino%2BPared.html" />
    <link rel="prev" title="1. Teoría potencial linealizada 2D" href="1.Notebook_RANKINE.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    pyAero Course
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="1.Notebook_RANKINE.html">1. Teoría potencial linealizada 2D</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">1.2. Teoría potencial linealizada 2D</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../02-torbellino-pared/2.Notebook_Torbellino%2BPared.html">2. Campo fluido generado por un torbellino individual en presencia de una pared</a></li>
<li class="toctree-l1"><a class="reference internal" href="../03-manantial-esquina/3.Notebook_Manantial%2BEsquina.html">3. Campo fluido generado por un manantial aislado en presencia de una esquina</a></li>
<li class="toctree-l1"><a class="reference internal" href="../04-manantiales-alineados/4.Notebook_Manantiales-Alineados.html">4. Campo fluido generado por tres manantiales alineados dispuestos de forma simétrica</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/RayleighLord/pyAeroTest" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/RayleighLord/pyAeroTest/issues/new?title=Issue%20on%20page%20%2Fnotebooks/01-rankine/1b.Notebook_RANKINE - SOL.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/notebooks/01-rankine/1b.Notebook_RANKINE - SOL.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Teoría potencial linealizada 2D</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ovalo-de-rankine">1.2.1. Óvalo de Rankine</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codigo-python-para-el-calculo-del-flujo-potencial-asociado-a-el-ovalo-de-rankine">1.2.1.1. Código Python para el cálculo del flujo potencial asociado a el óvalo de Rankine</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculo-de-la-velocidad-generada-por-la-distribucion-de-singularidades-en-un-punto-discreto">1.2.1.2. Cálculo de la velocidad generada por la distribución de singularidades en un punto discreto</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculo-de-la-velocidad-y-la-presion-en-un-punto-dado">1.2.1.3. Cálculo de la velocidad y la presión en un punto dado</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="teoria-potencial-linealizada-2d">
<h1><span class="section-number">1.2. </span>Teoría potencial linealizada 2D<a class="headerlink" href="#teoria-potencial-linealizada-2d" title="Permalink to this heading">#</a></h1>
<p>La teoría potencial linealizada bidimensional se basa en la resolución de la ecuación de Laplace en dos dimensiones para un fluido incompresible y estacionario. En esta teoría, se asume que las fluctuaciones en la velocidad y la presión son pequeñas en comparación con las velocidades y presiones características del fluido. Frente a una resolución de las ecuaciones en cada punto del espacio discretizado, como podría ser a través del método de elementos o volúmenes finitos, a través del método de singularidades se calcula la velocidad en el campo fluido a través de la integración o sumatorio de la contribución de éstas, como se muestra en la figura inferior. Se emplean manantiales, sumideros, torbellinos, que pueden ser estar localizados de forma puntual, o extendidos en líneas o planos. Esta metodología es la que se utiliza habitualmente en la elaboración de los conocidos Métodos de Paneles o entramados de torbellinos (<em>Vortex Lattice</em>)</p>
<p align="center">
  <img width="800" src=../../img/Grid_vs_Singularity_Drela.png>
<br><b>Método de malla discretizada frente a método de singularidades. <br>Imagen modificada de <i>"Flight Vehicle Aerodynamics"</i> (MIT Press, 2014)</b>
</p>
<section id="ovalo-de-rankine">
<h2><span class="section-number">1.2.1. </span>Óvalo de Rankine<a class="headerlink" href="#ovalo-de-rankine" title="Permalink to this heading">#</a></h2>
<p>El óvalo de Rankine es un modelo matemático que representa un sistema de flujo en dos dimensiones. Se compone de dos singularidades, un manantial y un sumidero, alineados con la corriente incidente. La localización de los puntos de remanso y la forma del óvalo están determinados por la relación entre la intensidad de las singularidades y la corriente incidente, pudiendo estudiarse como una relación de gastos, como se ha visto en las clases de problemas.</p>
<section id="codigo-python-para-el-calculo-del-flujo-potencial-asociado-a-el-ovalo-de-rankine">
<h3><span class="section-number">1.2.1.1. </span>Código Python para el cálculo del flujo potencial asociado a el óvalo de Rankine<a class="headerlink" href="#codigo-python-para-el-calculo-del-flujo-potencial-asociado-a-el-ovalo-de-rankine" title="Permalink to this heading">#</a></h3>
<p>En los siguientes párrafos se presenta una propuesta de cálculo numérico para el modelado discreto del flujo potencial. Existen muchas formas de realizar este cálculo, en este texto se presenta una alternativa sencilla que hace uso del módulo <em>NumPy</em> de Python, así como una representación gráfica de la función de corriente y el campo de velocidades.</p>
<p>Nótese que en lo que corresponde al texto escrito en este documento, se usan variables en <strong>negrita</strong> para denotar vectores o matrices.</p>
<p>Junto a este documento se dispone de códigos MatLab o Python para su ejecución independiente, así como del Notebook original.</p>
<p>Del mismo modo, se puede ejecutar de forma online a través del siguiente enlace: <a class="reference external" href="https://mybinder.org/v2/gh/AMartinezCava/pyAero/HEAD?labpath=Notebook_RANKINE.ipynb"><img alt="Binder" src="https://mybinder.org/badge_logo.svg" /></a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1. Importación de módulos</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid1</span> <span class="kn">import</span> <span class="n">make_axes_locatable</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 2. Definición de las funciones de cálculo del campo de velocidades</span>
<span class="k">def</span> <span class="nf">velocity_field</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">x_s</span><span class="p">,</span> <span class="n">z_s</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calcula el campo de velocidades inducido por una serie finita de manantiales y sumideros.</span>
<span class="sd">    </span>
<span class="sd">    Parámetros:</span>
<span class="sd">    x, z -- coordenadas en el plano xz</span>
<span class="sd">    Q -- magnitud de los manantiales/sumideros</span>
<span class="sd">    x_s, z_s -- coordenadas de los manantiales/sumideros</span>
<span class="sd">    </span>
<span class="sd">    Devuelve:</span>
<span class="sd">    u, w -- componentes del campo de velocidades</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;f8&#39;</span><span class="p">)</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;f8&#39;</span><span class="p">)</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="n">x_s</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">z</span> <span class="o">-</span> <span class="n">z_s</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">u</span> <span class="o">+=</span> <span class="n">Q</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">x_s</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">r</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">w</span> <span class="o">+=</span> <span class="n">Q</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">z</span> <span class="o">-</span> <span class="n">z_s</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">r</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">u</span><span class="p">,</span> <span class="n">w</span>
</pre></div>
</div>
</div>
</div>
<p>La función <em>velocity_field</em> toma como entrada las coordenadas <strong>x</strong> e <strong>z</strong> en el plano xz, la magnitud <strong>Q</strong> de los manantiales y sumideros, y las coordenadas <strong>x_s</strong>, <strong>z_s</strong> de los manantiales y sumideros. La función devuelve las componentes <strong>u</strong> y <strong>w</strong> del campo de velocidades.</p>
<p>Para calcular las componentes del campo de velocidades, se utiliza un ciclo for que recorre cada uno de los manantiales y sumideros y calcula la contribución de cada uno de ellos en las componentes <strong>u</strong> y <strong>w</strong> utilizando la formulación matemática correspondiente (que puede ser deducida analíticamente a partir de los contenidos teóricos de la asignatura).</p>
<p>Por ejemplo, la formulación matemática utilizada aqui para calcular la velocidad horizontal inducida por un manantial de intensidad <span class="math notranslate nohighlight">\(Q\)</span>, que se encuentra localizado en <span class="math notranslate nohighlight">\((x_Q, z_Q)\)</span>, en un punto del espacio, <span class="math notranslate nohighlight">\(p\)</span>, situado a una distancia radial <span class="math notranslate nohighlight">\(r\)</span>, es la siguiente:</p>
<div class="math notranslate nohighlight">
\[ U = \frac{Q}{2\pi r}\cos{\theta} = \frac{Q}{2\pi r} \frac{(x_p-x_Q)}{r}\]</div>
<p>Podemos utilizar esta función para calcular el campo de velocidades en los distintos ejes del sistema de referencia empleado, tanto a nivel vectorial como a nivel puntual, y usar esos datos para visualizar la solución en un gráfico.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Definimos la magnitud y ángulo de la velocidad incidente</span>
<span class="n">U_inf</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># Definimos las coordenadas de los manantiales y sumideros</span>
<span class="n">Q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">15</span><span class="p">,</span> <span class="o">-</span><span class="mi">15</span><span class="p">])</span>
<span class="n">x_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">z_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

<span class="c1"># Se definen también sus coordenadas en el plano complejo, para el cálculo del potencial.</span>
<span class="n">t_s</span> <span class="o">=</span> <span class="n">x_s</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">z_s</span>
<span class="n">num_sources</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>

<span class="c1"># Definimos una malla para las coordenadas x e z</span>
<span class="n">nx</span><span class="p">,</span> <span class="n">nz</span> <span class="o">=</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">40</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">nx</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">nz</span><span class="p">)</span>
<span class="n">Xm</span><span class="p">,</span> <span class="n">Zm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
<span class="n">Tm</span> <span class="o">=</span> <span class="n">Xm</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">Zm</span>

<span class="c1"># Calculamos las componentes u y v del campo de velocidades inducido por los manantiales o sumideros</span>
<span class="n">u</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">velocity_field</span><span class="p">(</span><span class="n">Xm</span><span class="p">,</span> <span class="n">Zm</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">x_s</span><span class="p">,</span> <span class="n">z_s</span><span class="p">)</span>

<span class="c1"># Añadimos el componente de la velocidad incidente</span>
<span class="n">u</span> <span class="o">+=</span> <span class="n">U_inf</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">alpha</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span>
<span class="n">w</span> <span class="o">+=</span> <span class="n">U_inf</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">alpha</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span>

<span class="c1"># Construimos la funcion potencial</span>
<span class="n">pot</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_sources</span><span class="p">):</span>
    <span class="n">pot</span> <span class="o">+=</span> <span class="n">Q</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">Tm</span> <span class="o">-</span> <span class="n">t_s</span><span class="p">[</span><span class="n">s</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
<span class="n">pot</span> <span class="o">+=</span> <span class="n">U_inf</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">alpha</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span> <span class="o">*</span> <span class="n">Tm</span>

<span class="c1"># De la función potencial extraemos tanto el potencial de velocidades (Phi) como la función de corriente (Psi)</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">pot</span><span class="o">.</span><span class="n">real</span>
<span class="n">psi</span> <span class="o">=</span> <span class="n">pot</span><span class="o">.</span><span class="n">imag</span>
</pre></div>
</div>
</div>
</div>
<p>Una vez calculados el campo de velocidades, se calcula la función potencial de la forma habitual. Se recuerda que <span class="math notranslate nohighlight">\(f(t) = \Phi - i\Psi\)</span>, por lo que tras construir <span class="math notranslate nohighlight">\(f(t)\)</span> es sencillo extraer tanto el potencial de velocidades, <span class="math notranslate nohighlight">\(\Phi\)</span>, como la función de corriente, <span class="math notranslate nohighlight">\(\Psi\)</span>.</p>
<p>Tras la fase de cálculo, es conveniente representar gráficamente la solución. Para ello hacemos uso de las funciones <em>contourf</em> y <em>contour</em> de Matplotlib, para representar el campo de la Función de Corriente (<span class="math notranslate nohighlight">\(\Psi\)</span>), y la línea de corriente correspondiente a <span class="math notranslate nohighlight">\(\Psi=0\)</span>.</p>
<p>Por último, empleamos la función <em>quiver</em> para representar el campo de velocidades vectorial de forma más visual. Por defecto, esta función representa la longitud de los vectores de forma inversa a su magnitud, por lo que aquí se realiza una normalización previa.
Aunque sabemos que <span class="math notranslate nohighlight">\(\dot{f}(t)= \Phi_x - i \Phi_z = U - iW\)</span>, disponemos del campo de velocidades calculado previamente, en las variables <strong>u</strong> y <strong>w</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualizamos la función de corriente y la función potencial</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>                        <span class="c1"># Creamos la figura</span>
<span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>         

<span class="n">dividerPSI</span> <span class="o">=</span> <span class="n">make_axes_locatable</span><span class="p">(</span><span class="n">ax1</span><span class="p">)</span>                                  <span class="c1"># Ajustamos la posición de la barra de niveles</span>
<span class="n">caxPSI</span> <span class="o">=</span> <span class="n">dividerPSI</span><span class="o">.</span><span class="n">append_axes</span><span class="p">(</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s1">&#39;5%&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">cont</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">Xm</span><span class="p">,</span> <span class="n">Zm</span><span class="p">,</span> <span class="n">psi</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;bwr&#39;</span><span class="p">)</span>                       <span class="c1"># Pintamos los contornos</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">Xm</span><span class="p">,</span> <span class="n">Zm</span><span class="p">,</span> <span class="n">psi</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">],</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">1.2</span><span class="p">)</span> <span class="c1"># Representamos la línea de corriente psi=0    </span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cont</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">caxPSI</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>                 <span class="c1"># Pintamos la barra de niveles</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Función de corriente $\Psi$&#39;</span><span class="p">)</span>

<span class="n">dividerPHI</span> <span class="o">=</span> <span class="n">make_axes_locatable</span><span class="p">(</span><span class="n">ax2</span><span class="p">)</span>                                  <span class="c1"># Ajustamos la posición de la barra de niveles</span>
<span class="n">caxPHI</span> <span class="o">=</span> <span class="n">dividerPHI</span><span class="o">.</span><span class="n">append_axes</span><span class="p">(</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s1">&#39;5%&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">cont</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">Xm</span><span class="p">,</span> <span class="n">Zm</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;bwr&#39;</span><span class="p">)</span>                       <span class="c1"># Pintamos los contornos</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">Xm</span><span class="p">,</span> <span class="n">Zm</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">],</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">1.2</span><span class="p">)</span> <span class="c1"># Representamos la línea de corriente psi=0    </span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cont</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">caxPHI</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>                 <span class="c1"># Pintamos la barra de niveles</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Función Potencial $\Phi$&#39;</span><span class="p">)</span>

<span class="n">N</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">u</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">w</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>                                           
<span class="n">ax1</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">Xm</span><span class="p">,</span> <span class="n">Zm</span><span class="p">,</span> <span class="n">u</span><span class="o">/</span><span class="n">N</span><span class="p">,</span> <span class="n">w</span><span class="o">/</span><span class="n">N</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>                                 <span class="c1"># Representamos el campo vectorial normalizado</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">Xm</span><span class="p">,</span> <span class="n">Zm</span><span class="p">,</span> <span class="n">u</span><span class="o">/</span><span class="n">N</span><span class="p">,</span> <span class="n">w</span><span class="o">/</span><span class="n">N</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>     

<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>                                                 <span class="c1"># Etiquetamos de forma apropiada, y mostramos en pantalla</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span><span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/1a9e79db487841b79abfded0a2d1d42a39ce73b5043b308abd1d208b08ea80e7.png" src="../../_images/1a9e79db487841b79abfded0a2d1d42a39ce73b5043b308abd1d208b08ea80e7.png" />
</div>
</div>
<p>En este caso, la visualización vectorial (a través de la función <em>quiver</em>) puede confundir al observador, al parecer que hay vectores que “atraviesen la línea de corriente dibujada que conforma el óvalo. Téngase en cuenta que los vectores dibujados dependen de la discretización espacial utilizada, y su longitud está condicionada por el parámetro <em>scale</em> utilizado en la llamada a la función. La velocidad es <strong>siempre</strong> tangente a las líneas de corriente, y éstas <strong>nunca</strong> se pueden cruzar.</p>
<p>De forma similar al proceso antes realizado, podríamos representar el campo de velocidades tanto horizontal como vertical:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualizamos el campo de velocidades y la función de corriente</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span> 
<span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>                                             <span class="c1"># Creamos la figura, con dos plots integrados</span>

<span class="n">dividerU</span> <span class="o">=</span> <span class="n">make_axes_locatable</span><span class="p">(</span><span class="n">ax1</span><span class="p">)</span>                                   <span class="c1"># Ajustamos la posición de la barra de niveles en U</span>
<span class="n">caxU</span> <span class="o">=</span> <span class="n">dividerU</span><span class="o">.</span><span class="n">append_axes</span><span class="p">(</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s1">&#39;5%&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">dividerV</span> <span class="o">=</span> <span class="n">make_axes_locatable</span><span class="p">(</span><span class="n">ax2</span><span class="p">)</span>                                   <span class="c1"># Ajustamos la posición de la barra de niveles en W</span>
<span class="n">caxV</span> <span class="o">=</span> <span class="n">dividerV</span><span class="o">.</span><span class="n">append_axes</span><span class="p">(</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s1">&#39;5%&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Velocidad horizontal $\Phi_x$&#39;</span><span class="p">)</span>
<span class="n">cont</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">Xm</span><span class="p">,</span> <span class="n">Zm</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;hot&#39;</span><span class="p">)</span>                        <span class="c1"># Pintamos los contornos de U</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">Xm</span><span class="p">,</span> <span class="n">Zm</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">],</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>   <span class="c1"># Representamos lineas de isocontornos</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cont</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">caxU</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>                  <span class="c1"># Pintamos la barra de niveles</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Velocidad vertical $-\Phi_z$&#39;</span><span class="p">)</span>
<span class="n">cont</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">Xm</span><span class="p">,</span> <span class="n">Zm</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;hot&#39;</span><span class="p">)</span>                        <span class="c1"># Pintamos los contornos</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">Xm</span><span class="p">,</span> <span class="n">Zm</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">],</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>   <span class="c1"># Representamos la línea de corriente psi=0    </span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cont</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">caxV</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>                  <span class="c1"># Pintamos la barra de niveles</span>


<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>                                                <span class="c1"># Etiquetamos de forma apropiada, y mostramos en pantalla</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
    <span class="c1">#ax.set(xlim=(-3, -1), ylim=(-1, 1))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span><span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/603895132c9eeb014ef41b45a38feaec9601c852ecd0f4543fe645b36a68e096.png" src="../../_images/603895132c9eeb014ef41b45a38feaec9601c852ecd0f4543fe645b36a68e096.png" />
</div>
</div>
</section>
<section id="calculo-de-la-velocidad-generada-por-la-distribucion-de-singularidades-en-un-punto-discreto">
<h3><span class="section-number">1.2.1.2. </span>Cálculo de la velocidad generada por la distribución de singularidades en un punto discreto<a class="headerlink" href="#calculo-de-la-velocidad-generada-por-la-distribucion-de-singularidades-en-un-punto-discreto" title="Permalink to this heading">#</a></h3>
<p>Es habitual al emplearse métodos numéricos que pueden ligarse a una discretización espacial caer en el error de restringir nuestro análisis a ésta. Poniendo como recurso la Figura 1 de este documento, sería el considerar que todo cálculo va ir ligado a un “<em>grid method</em>”, donde solo tendremos resultados en aquellos puntos definidos por nuestra malla (<em>grid</em>), o discretización espacial. Esto es cierto en las aproximaciones por elementos o volúmenes finitos, por ejemplo, donde en cada elemento de la malla se resuelven las ecuaciones diferenciales correspondientes al problema que estemos analizando, obteniéndose valores particulares para el nodo o la celda. Estos valores nodales pueden interpolarse para generar mapas de contorno para visualizar la solución:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">Xm</span><span class="p">,</span> <span class="n">Zm</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">Xm</span><span class="p">,</span> <span class="n">Zm</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">u</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;hot&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xm</span><span class="p">,</span> <span class="n">Zm</span><span class="p">,</span> <span class="s1">&#39;kx&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">Xm</span><span class="p">,</span> <span class="n">Zm</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;hot&#39;</span><span class="p">)</span>  

<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span><span class="s1">&#39;box&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="c1">#plt.tight_layout()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/7b2e03f4f5636bb6c0d5fbc209ad2d9d363d27f091d7451e1cfcc6f6b1fee553.png" src="../../_images/7b2e03f4f5636bb6c0d5fbc209ad2d9d363d27f091d7451e1cfcc6f6b1fee553.png" />
</div>
</div>
<p>Sin embargo, el metodo de las singularidades responde a la imagen derecha de la Figura 1, ofreciendo mucha más versatilidad <strong>independiente</strong> de una posible discretización espacial.
La función <em>velocity_field</em> definida en este Notebook permite el cálculo de la velocidad <strong>en cualquier punto del espacio</strong>, dada una distribución de singularidades. El uso de una discretización espacial (definida mediante las variables <em>nx</em> y <em>nz</em>) se usa aquí solamente para la representación gráfica de la solución, como se ha comentado previamente.</p>
<p>Visualicemos, como ejemplo, los puntos de la malla equiespaciada (círculos negros) definida sobre una distribución de velocidades, para distinto número de elementos en cada dirección, además del punto en el cual queremos conocer la velocidad (círculo verde):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Definimos el punto donde queremos calcular la velocidad</span>
<span class="n">xp</span><span class="p">,</span> <span class="n">zp</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span>

<span class="c1"># Definimos el número de elementos de las discretizaciones a realizar</span>
<span class="n">n_set</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">40</span><span class="p">]</span>
<span class="c1"># Generamos una figura que contenga 3 subfiguras, en una fila y 3 columnas, que compartan la etiqueta del eje vertical</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
<span class="c1"># Iteramos a la vez la lista n_set y los 3 objetos de las subfiguras</span>
<span class="k">for</span> <span class="n">nn</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">n_set</span><span class="p">,</span> <span class="n">axes</span><span class="p">):</span>
    <span class="n">xg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">nn</span><span class="p">)</span>
    <span class="n">zg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">nn</span><span class="p">)</span>
    <span class="n">Xmg</span><span class="p">,</span> <span class="n">Zmg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">xg</span><span class="p">,</span> <span class="n">zg</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xmg</span><span class="p">,</span> <span class="n">Zmg</span><span class="p">,</span> <span class="s1">&#39;ko&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">Xm</span><span class="p">,</span> <span class="n">Zm</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;hot&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span><span class="s1">&#39;box&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Discretización de dimensión &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">nn</span><span class="p">))</span>

<span class="c1"># Pintamos en todas las figuras el punto donde queremos calcular la velocidad (sacado del bucle superior por claridad)</span>
<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xp</span><span class="p">,</span> <span class="n">zp</span><span class="p">,</span> <span class="s1">&#39;go&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/e3d796e5854618ad7b12f07c3e3683acdf0e59a691b012d3c9e8b3ac7b5ab5fc.png" src="../../_images/e3d796e5854618ad7b12f07c3e3683acdf0e59a691b012d3c9e8b3ac7b5ab5fc.png" />
</div>
</div>
<p>Puede ser “intuitivo” acudir a la discretización espacial para recuperar, por ejemplo la distribución de la velocidad horizontal mostrada en los gráficos. Para ello, uno debería acceder a la información contenida en la matriz <em>u</em>, teniendo en cuenta la localización espacial de cada uno de los modos (atención al especial detalle de MatLab y Python de tratar la coordenada Z en las filas y la X en las columnas). En ese caso, uno podría ver qué indice de <em>Xmg</em> y <em>Zmg</em> corresponde a coordenadas similares al punto (<em>xp,zp</em>), e intentar recuperar el valor de <em>u</em> indexando filas y columnas (<em>u[índice_z, índice_u]</em>).</p>
<p>Sin embargo, como se puede observar en los gráficos mostrados arriba, a menos que la discretización espacial sea muy fina (o tengamos mucha suerte con la distribución de los nodos), acudir a la información contenida en los nodos puede dar lugar a error, ya que estaremos cometiendo un error espacial a menos que nos dediquemos a interpolar entre nodos. Este error se podrá hacer más pequeño si aumentamos enormemente la discretización, aunque es evidente que no es una técnica muy eficiente.</p>
<p>Aquí es donde el método de las singularidades cobra fuerza, gracias a su definición. Al tratarse de soluciones lineales, estas <strong>pueden superponerse</strong>, y por tanto <strong>sumar las contribuciones</strong> de cada una de las singularidades en un punto dado del espacio. Esto es precisamente lo que realiza la función <em>velocity_field</em>.</p>
<p>A través de la sección de código:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="n">x_s</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">z</span> <span class="o">-</span> <span class="n">z_s</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">u</span> <span class="o">+=</span> <span class="n">Q</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">x_s</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">r</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">w</span> <span class="o">+=</span> <span class="n">Q</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">z</span> <span class="o">-</span> <span class="n">z_s</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">r</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">u</span><span class="p">,</span> <span class="n">w</span>
</pre></div>
</div>
<p>sumamos las contribuciones de los distintos manantiales, calculando directamente la distancia del punto de interés a la singularidad.</p>
<p>Veámoslo de forma detallada en la siguiente sección de código. Nótese que en todo el cálculo que resta no se hace uso en absoluto de la discretización espacial (solo necesaria para la representación gráfica de la velocidad horizontal, pero no usada de nuevo en ningún momento).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generamos dos figura y pintamos en ambas el contorno de velocidades, la localización de las singularidades (cuadrados azules) y el punto de interes (círculo verde)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">Xm</span><span class="p">,</span> <span class="n">Zm</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;hot&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xp</span><span class="p">,</span> <span class="n">zp</span><span class="p">,</span> <span class="s1">&#39;go&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_sources</span><span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_s</span><span class="p">[</span><span class="n">s</span><span class="p">],</span> <span class="n">z_s</span><span class="p">[</span><span class="n">s</span><span class="p">],</span> <span class="s1">&#39;sb&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xp</span><span class="p">,</span> <span class="n">x_s</span><span class="p">[</span><span class="n">s</span><span class="p">]],</span> <span class="p">[</span><span class="n">zp</span><span class="p">,</span> <span class="n">z_s</span><span class="p">[</span><span class="n">s</span><span class="p">]],</span> <span class="s1">&#39;k--&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span><span class="s1">&#39;box&#39;</span><span class="p">)</span>

<span class="c1">## PRIMERA FIGURA ##</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Contribuciones individuales de las singularidades&#39;</span><span class="p">)</span>
<span class="c1"># Pintamos la contribución del manantial (situado a la izquierda), como una flecha roja</span>
<span class="n">scale</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">um</span><span class="p">,</span> <span class="n">wm</span> <span class="o">=</span> <span class="n">velocity_field</span><span class="p">(</span><span class="n">xp</span><span class="p">,</span> <span class="n">zp</span><span class="p">,</span> <span class="p">[</span><span class="n">Q</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="n">x_s</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="n">z_s</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">xp</span><span class="p">,</span> <span class="n">zp</span><span class="p">,</span> <span class="n">um</span><span class="o">*</span><span class="n">scale</span><span class="p">,</span> <span class="n">wm</span><span class="o">*</span><span class="n">scale</span><span class="p">,</span> <span class="n">head_width</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

<span class="c1"># Pintamos la contribución del sumidero (situado a la derecha), como una flecha azul</span>
<span class="n">scale</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">us</span><span class="p">,</span> <span class="n">ws</span> <span class="o">=</span> <span class="n">velocity_field</span><span class="p">(</span><span class="n">xp</span><span class="p">,</span> <span class="n">zp</span><span class="p">,</span> <span class="p">[</span><span class="n">Q</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="n">x_s</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="n">z_s</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">xp</span><span class="p">,</span> <span class="n">zp</span><span class="p">,</span> <span class="n">us</span><span class="o">*</span><span class="n">scale</span><span class="p">,</span> <span class="n">ws</span><span class="o">*</span><span class="n">scale</span><span class="p">,</span> <span class="n">head_width</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>

<span class="c1"># Pintamos la contribución de la corriente incidente, como una flecha verde</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">xp</span><span class="p">,</span> <span class="n">zp</span><span class="p">,</span> <span class="n">U_inf</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">head_width</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>

<span class="c1">## SEGUNDA FIGURA ##</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Velocidad resultante&#39;</span><span class="p">)</span>
<span class="c1"># Calculamos la velocidad resultante generada por ambas distribuciones y la corriente incidente, como una flecha negra</span>
<span class="n">ut</span><span class="p">,</span> <span class="n">wt</span> <span class="o">=</span> <span class="n">velocity_field</span><span class="p">(</span><span class="n">xp</span><span class="p">,</span> <span class="n">zp</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">x_s</span><span class="p">,</span> <span class="n">z_s</span><span class="p">)</span>
<span class="n">ut</span> <span class="o">+=</span> <span class="n">U_inf</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">xp</span><span class="p">,</span> <span class="n">zp</span><span class="p">,</span> <span class="n">ut</span><span class="p">,</span> <span class="n">wt</span><span class="p">,</span> <span class="n">head_width</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.patches.FancyArrow at 0x7f3d5c9506d0&gt;
</pre></div>
</div>
<img alt="../../_images/08014510b56d933f2bfba602540268a050b7b85d2249022fcc75d0161ea02d4a.png" src="../../_images/08014510b56d933f2bfba602540268a050b7b85d2249022fcc75d0161ea02d4a.png" />
</div>
</div>
<p>La representación del vector velocidad de la figura derecha es la suma vectorial (de forma <strong>lineal</strong>) de los tres vectores mostrados en la figura izquierda, cada uno contribución individual al campo de velocidades total.</p>
<p>Es evidente que, de cara al cálculo de las velocidades en un punto dado, no tenemos que calcular de forma independiente cada una de las contribuciones. Basta con llamar una sola vez a la función <em>velocity_field</em>, como se hace en el segmento final del código arriba propuesto, otorgando las coordenadas de entrada y salida correspondientes. Téngase en cuenta que la función ahora mismo está diseñada para sumar las contribuciones de una distribución finita de manantiales, por ello se debe sumar la velocidad incidente en un paso adicional. Si se quisiese tener en cuenta otras singularidades, bastaría con modificar la función, o generar una nueva función y sumar linealmente las contribuciones.</p>
</section>
<section id="calculo-de-la-velocidad-y-la-presion-en-un-punto-dado">
<h3><span class="section-number">1.2.1.3. </span>Cálculo de la velocidad y la presión en un punto dado<a class="headerlink" href="#calculo-de-la-velocidad-y-la-presion-en-un-punto-dado" title="Permalink to this heading">#</a></h3>
<p>Visto el potencial de la función <em>velocity_field</em>, podemos en este caso obtener las velocidades horizontal y vertical <strong>en cualquier punto del espacio</strong>, así como la presión estática conocida una presión de referencia.
Para el cálculo de estas variables en el punto <span class="math notranslate nohighlight">\((x_p,z_p)=(2,3)\)</span> haríamos uso del procedimiento antes mencionado, así como de la Ecuación de Bernoulli, al tratarse de un flujo ideal, estacionario e incompresible:</p>
<div class="math notranslate nohighlight">
\[p = p_{\infty} + \frac{\rho}{2}(U_{\infty}-u^2)\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Obtenemos las velocidades en el punto deseado</span>
<span class="n">xp</span><span class="p">,</span> <span class="n">zp</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span>
<span class="n">up</span><span class="p">,</span> <span class="n">wp</span> <span class="o">=</span> <span class="n">velocity_field</span><span class="p">(</span><span class="n">xp</span><span class="p">,</span> <span class="n">zp</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">x_s</span><span class="p">,</span> <span class="n">z_s</span><span class="p">)</span>
<span class="n">up</span> <span class="o">+=</span> <span class="n">U_inf</span>

<span class="n">p_inf</span> <span class="o">=</span> <span class="mf">1e5</span>
<span class="n">rho</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">p_inf</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">rho</span><span class="o">*</span><span class="p">(</span><span class="n">U_inf</span><span class="o">-</span><span class="n">up</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;La velocidad, en m/s en el punto (x, z)=(</span><span class="si">{0:3.1f}</span><span class="s1">, </span><span class="si">{1:3.1f}</span><span class="s1">) es (u, w)=(</span><span class="si">{2:6.4f}</span><span class="s1">, </span><span class="si">{3:6.4f}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">xp</span><span class="p">,</span> <span class="n">zp</span><span class="p">,</span> <span class="n">up</span><span class="p">,</span> <span class="n">wp</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;La presión estática en el punto (x, z)=(</span><span class="si">{0:3.1f}</span><span class="s1">, </span><span class="si">{1:3.1f}</span><span class="s1">) es p=</span><span class="si">{2:4.2f}</span><span class="s1"> Pa&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">xp</span><span class="p">,</span> <span class="n">zp</span><span class="p">,</span> <span class="n">p</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>La velocidad, en m/s en el punto (x, z)=(2.0, 3.0) es (u, w)=(2.6860, -0.2744)
La presión estática en el punto (x, z)=(2.0, 3.0) es p=99999.66 Pa
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks/01-rankine"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="1.Notebook_RANKINE.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">1. </span>Teoría potencial linealizada 2D</p>
      </div>
    </a>
    <a class="right-next"
       href="../02-torbellino-pared/2.Notebook_Torbellino%2BPared.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">2. </span>Campo fluido generado por un torbellino individual en presencia de una pared</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ovalo-de-rankine">1.2.1. Óvalo de Rankine</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codigo-python-para-el-calculo-del-flujo-potencial-asociado-a-el-ovalo-de-rankine">1.2.1.1. Código Python para el cálculo del flujo potencial asociado a el óvalo de Rankine</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculo-de-la-velocidad-generada-por-la-distribucion-de-singularidades-en-un-punto-discreto">1.2.1.2. Cálculo de la velocidad generada por la distribución de singularidades en un punto discreto</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculo-de-la-velocidad-y-la-presion-en-un-punto-dado">1.2.1.3. Cálculo de la velocidad y la presión en un punto dado</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            <div class="bd-footer-content__inner">
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By pyAero
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div></div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>